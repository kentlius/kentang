---
import BaseHead, {
  type Props as HeadProps,
} from "../components/BaseHead.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";

export type Props = HeadProps;

const { ...head } = Astro.props;
---

<script is:inline>
  const getThemePreference = () => {
    if (typeof localStorage !== "undefined" && localStorage.getItem("theme")) {
      return localStorage.getItem("theme");
    }
    return window.matchMedia("(prefers-color-scheme: dark)").matches
      ? "dark"
      : "light";
  };
  const isDark = getThemePreference() === "dark";
  document.documentElement.classList[isDark ? "add" : "remove"]("dark");

  // if (typeof localStorage !== "undefined") {
  //   const observer = new MutationObserver(() => {
  //     const isDark = document.documentElement.classList.contains("dark");
  //     localStorage.setItem("theme", isDark ? "dark" : "light");
  //   });
  //   observer.observe(document.documentElement, {
  //     attributes: true,
  //     attributeFilter: ["class"],
  //   });
  // }
</script>

<html lang="en">
  <head>
    <BaseHead {...head} />
  </head>
  <body
    class="dark:bg-gray-900 dark:text-white transition-colors duration-700 selection:bg-fuchsia-300 selection:text-fuchsia-900"
  >
    <div class="container mx-auto max-w-2xl px-4 py-20">
      <Header />
      <slot />
      <Footer />
    </div>
  </body>
</html>
